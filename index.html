<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ITPYX Company Lahore</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&family=Poppins&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(to right, #1f1c2c, #928dab);
      color: #fff;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }
    h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: 3rem;
      margin-top: 40px;
      text-shadow: 2px 2px #000;
    }
    form, .download-section {
      background: rgba(255, 255, 255, 0.1);
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.3);
      width: 90%;
      max-width: 400px;
      margin: 20px 0;
    }
    input {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
    }
    button {
      width: 100%;
      background-color: #00c9a7;
      color: white;
      border: none;
      padding: 14px;
      font-size: 1rem;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover {
      background-color: #02b39b;
    }
  </style>
</head>
<body>
  <h1>ITPYX Company Lahore</h1>
  <form id="employment-form">
    <input type="text" name="Full Name" placeholder="Full Name" required>
    <input type="text" name="Father's Name" placeholder="Father's Name" required>
    <input type="email" name="Email" placeholder="Email Address" required>
    <input type="text" name="Whatsapp No" placeholder="WhatsApp Number" required>
    <input type="text" name="Qualification" placeholder="Qualification" required>
    <input type="text" name="City" placeholder="City" required>
    <button type="submit">Submit</button>
  </form>  <div class="download-section">
    <input type="email" id="email-search" placeholder="Enter your email to download CV">
    <button onclick="downloadCV()">Download CV</button>
  </div>  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbyujC-_fWEiL4L7MGKdOsxNrJVj33aHVFX9AZhR-CQfPg0YIDOzITsBk5GYczb5FQCK2Q/exec';
    const form = document.getElementById('employment-form');

    form.addEventListener('submit', e => {
      e.preventDefault();
      fetch(scriptURL, {
        method: 'POST',
        body: new FormData(form)
      })
      .then(response => alert('Form submitted successfully!'))
      .catch(error => alert('Error!', error.message));
    });

    async function downloadCV() {
      const email = document.getElementById('email-search').value.trim();
      if (!email) return alert('Please enter your email');

      const response = await fetch('https://opensheet.vercel.app/18QClmPRcA6wxLYnDp5qijPhm2Si4s56oWWdZ-H-y0DE/Sheet1');
      const data = await response.json();
      const entry = data.find(d => d.Email.toLowerCase() === email.toLowerCase());

      if (!entry) return alert('No record found for this email.');

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.setFont('helvetica', 'bold');
      doc.setFontSize(20);
      doc.text("ITPYX Company Lahore", 20, 20);

      doc.setFontSize(12);
      doc.setFont('helvetica', 'normal');
      doc.text(`Full Name: ${entry['Full Name']}`, 20, 40);
      doc.text(`Father's Name: ${entry["Father's Name"]}`, 20, 50);
      doc.text(`Email: ${entry.Email}`, 20, 60);
      doc.text(`Whatsapp No: ${entry['Whatsapp No']}`, 20, 70);
      doc.text(`Qualification: ${entry.Qualification}`, 20, 80);
      doc.text(`City: ${entry.City}`, 20, 90);

      doc.save(`${entry['Full Name'].replace(/\s+/g, '_')}_CV.pdf`);
    }
  </script>